<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>gen.summary — gen.summary • gnomeR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="gen.summary — gen.summary" />
<meta property="og:description" content="Creates a summary table of the distribution of the genetic features by a specific outcome/covariate of interest. The difference
is tested using Fisher's exact test and further adjusted for multiple comparisons. Note that continuous genetic factors
are dichotomized at their median." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gnomeR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Analizing-genomic-data.html">Analizing genomic data</a>
    </li>
    <li>
      <a href="../articles/Data-processing.html">Data-processing</a>
    </li>
    <li>
      <a href="../articles/Visualizations.html">Visualizations</a>
    </li>
    <li>
      <a href="../articles/gnomeR-vignette.html">gnomeR for IMPACT data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/AxelitoMartin/gnomeR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>gen.summary</h1>
    <small class="dont-index">Source: <a href='https://github.com/AxelitoMartin/gnomeR/blob/master/R/gen-summary.R'><code>R/gen-summary.R</code></a></small>
    <div class="hidden name"><code>gen.summary.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Creates a summary table of the distribution of the genetic features by a specific outcome/covariate of interest. The difference
is tested using Fisher's exact test and further adjusted for multiple comparisons. Note that continuous genetic factors
are dichotomized at their median.</p>
    </div>

    <pre class="usage"><span class='fu'>gen.summary</span><span class='op'>(</span><span class='va'>gen.dat</span>, <span class='va'>outcome</span>, filter <span class='op'>=</span> <span class='fl'>0</span>, cont <span class='op'>=</span> <span class='cn'>F</span>, rank <span class='op'>=</span> <span class='cn'>T</span>, na.filt <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>gen.dat</th>
      <td><p>A matrix or dataframe, with patients as rows and features as columns.</p></td>
    </tr>
    <tr>
      <th>outcome</th>
      <td><p>A leveled vector of length equal to the number of rows in gen.dat.</p></td>
    </tr>
    <tr>
      <th>filter</th>
      <td><p>a numeric value between 0 and 1 (1 not included) that is the lower bound for the proportion of patients
having a genetic event (only for binary features). All features with an event rate lower than that value will be removed.
Default is 0 (all features included).</p></td>
    </tr>
    <tr>
      <th>cont</th>
      <td><p>Should the outcome be treated as a continuous value. Default is FALSE treated as categorical.</p></td>
    </tr>
    <tr>
      <th>rank</th>
      <td><p>Should the table returned be ordered by Pvalue. Boolean, default is T</p></td>
    </tr>
    <tr>
      <th>na.filt</th>
      <td><p>A numeric value between 0 and 1 (1 not included) that is the upper bound for the proportion of missing
values in the features of the inputted gen.dat matrix. Variables that exceed this proportion of missing values will be removed.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>fits : a table of odds ratio and pvalues.</p>
<p>forest.plot : A forest plot of the top 10 hits.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/AxelitoMartin/gnomeR'>gnomeR</a></span><span class='op'>)</span>
<span class='va'>patients</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>mut</span><span class='op'>$</span><span class='va'>Tumor_Sample_Barcode</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'>## binary outcome ##</span>
<span class='va'>outcome</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>clin.sample</span><span class='op'>$</span><span class='va'>Sample.Type</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/match.html'>match</a></span><span class='op'>(</span><span class='va'>patients</span>,<span class='va'>clin.sample</span><span class='op'>$</span><span class='va'>Sample.Identifier</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>gen.dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='binmat.html'>binmat</a></span><span class='op'>(</span>patients <span class='op'>=</span> <span class='va'>patients</span>,maf <span class='op'>=</span> <span class='va'>mut</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: MUTATION DATA: To ensure gene with multiple names/aliases are correctly grouped together, the</span>
#&gt; <span class='warning'>      following genes in your maf dataframe have been recoded. You can supress this with recode.aliases = FALSE </span>
#&gt; <span class='warning'> </span>
#&gt; <span class='warning'>MLL3 recoded to KMT2C </span>
#&gt; <span class='warning'>MUTATION DATA: To ensure gene with multiple names/aliases are correctly grouped together, the</span>
#&gt; <span class='warning'>      following genes in your maf dataframe have been recoded. You can supress this with recode.aliases = FALSE </span>
#&gt; <span class='warning'> </span>
#&gt; <span class='warning'>MLL2 recoded to KMT2D </span>
#&gt; <span class='warning'>MUTATION DATA: To ensure gene with multiple names/aliases are correctly grouped together, the</span>
#&gt; <span class='warning'>      following genes in your maf dataframe have been recoded. You can supress this with recode.aliases = FALSE </span>
#&gt; <span class='warning'> </span>
#&gt; <span class='warning'>MRE11A recoded to MRE11 </span>
#&gt; <span class='warning'>MUTATION DATA: To ensure gene with multiple names/aliases are correctly grouped together, the</span>
#&gt; <span class='warning'>      following genes in your maf dataframe have been recoded. You can supress this with recode.aliases = FALSE </span>
#&gt; <span class='warning'> </span>
#&gt; <span class='warning'>MLL recoded to KMT2A </span>
#&gt; <span class='warning'>MUTATION DATA: To ensure gene with multiple names/aliases are correctly grouped together, the</span>
#&gt; <span class='warning'>      following genes in your maf dataframe have been recoded. You can supress this with recode.aliases = FALSE </span>
#&gt; <span class='warning'> </span>
#&gt; <span class='warning'>PARK2 recoded to PRKN </span>
#&gt; <span class='warning'>MUTATION DATA: To ensure gene with multiple names/aliases are correctly grouped together, the</span>
#&gt; <span class='warning'>      following genes in your maf dataframe have been recoded. You can supress this with recode.aliases = FALSE </span>
#&gt; <span class='warning'> </span>
#&gt; <span class='warning'>RFWD2 recoded to COP1 </span>
#&gt; <span class='warning'>MUTATION DATA: To ensure gene with multiple names/aliases are correctly grouped together, the</span>
#&gt; <span class='warning'>      following genes in your maf dataframe have been recoded. You can supress this with recode.aliases = FALSE </span>
#&gt; <span class='warning'> </span>
#&gt; <span class='warning'>PAK7 recoded to PAK5 </span>
#&gt; <span class='warning'>MUTATION DATA: To ensure gene with multiple names/aliases are correctly grouped together, the</span>
#&gt; <span class='warning'>      following genes in your maf dataframe have been recoded. You can supress this with recode.aliases = FALSE </span>
#&gt; <span class='warning'> </span>
#&gt; <span class='warning'>FAM46C recoded to TENT5C </span>
#&gt; <span class='warning'>MUTATION DATA: To ensure gene with multiple names/aliases are correctly grouped together, the</span>
#&gt; <span class='warning'>      following genes in your maf dataframe have been recoded. You can supress this with recode.aliases = FALSE </span>
#&gt; <span class='warning'> </span>
#&gt; <span class='warning'>FAM175A recoded to ABRAXAS1 </span>
#&gt; <span class='warning'>MUTATION DATA: To ensure gene with multiple names/aliases are correctly grouped together, the</span>
#&gt; <span class='warning'>      following genes in your maf dataframe have been recoded. You can supress this with recode.aliases = FALSE </span>
#&gt; <span class='warning'> </span>
#&gt; <span class='warning'>MYCL1 recoded to MYCL </span>
#&gt; <span class='warning'>MUTATION DATA: To ensure gene with multiple names/aliases are correctly grouped together, the</span>
#&gt; <span class='warning'>      following genes in your maf dataframe have been recoded. You can supress this with recode.aliases = FALSE </span>
#&gt; <span class='warning'> </span>
#&gt; <span class='warning'>TCEB1 recoded to ELOC </span></div><div class='output co'>#&gt; <span class='warning'>Warning: When panels argument is NULL only IMPACT samples can be annotated for missingness.</span>
#&gt; <span class='warning'>          If you are using GENIE data, we recommend that you provide this argument.</span></div><div class='input'><span class='fu'>gen.summary</span><span class='op'>(</span>gen.dat <span class='op'>=</span> <span class='va'>gen.dat</span>,
        outcome <span class='op'>=</span> <span class='va'>outcome</span>,
        filter <span class='op'>=</span> <span class='fl'>0.05</span>,
        cont <span class='op'>=</span> <span class='cn'>FALSE</span>,rank <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: geom_hline(): Ignoring `mapping` because `yintercept` was provided.</span></div><div class='output co'>#&gt; $fits
#&gt;        Feature Overall Metastasis(N=200) Primary(N=257) OddsRatio Lower Upper
#&gt; RB1        RB1  5.033%                7%         3.502%      0.48  0.18  1.23
#&gt; FAT1      FAT1  6.127%                8%         4.669%      0.56  0.24  1.31
#&gt; BRAF      BRAF  5.033%              6.5%         3.891%      0.58  0.22  1.48
#&gt; TERT      TERT  14.88%               17%         13.23%      0.74  0.43  1.29
#&gt; APC        APC  7.877%              9.5%         6.615%      0.68  0.32  1.42
#&gt; NOTCH1  NOTCH1   5.47%              6.5%         4.669%      0.71  0.29  1.72
#&gt; ARID1A  ARID1A  7.877%                9%         7.004%      0.76  0.36   1.6
#&gt; EGFR      EGFR  8.534%              9.5%         7.782%       0.8  0.39  1.64
#&gt; ATM        ATM   5.47%                6%         5.058%      0.84  0.34  2.05
#&gt; CDKN2A  CDKN2A  5.252%              5.5%         5.058%      0.92  0.37  2.31
#&gt; ATRX      ATRX  5.689%                6%         5.447%       0.9  0.38  2.19
#&gt; TP53      TP53 42.888%             43.5%        42.412%      0.96  0.65  1.41
#&gt; PIK3CA  PIK3CA 10.722%               11%        10.506%      0.95   0.5  1.81
#&gt; KRAS      KRAS 12.691%             12.5%         12.84%      1.03  0.57  1.88
#&gt;          Pvalue       FDR
#&gt; RB1    1.30e-01 0.8260000
#&gt; FAT1   1.70e-01 0.8260000
#&gt; BRAF   2.81e-01 0.8260000
#&gt; TERT   2.90e-01 0.8260000
#&gt; APC    2.95e-01 0.8260000
#&gt; NOTCH1 4.14e-01 0.9476923
#&gt; ARID1A 4.85e-01 0.9476923
#&gt; EGFR   6.13e-01 0.9476923
#&gt; ATM    6.83e-01 0.9476923
#&gt; CDKN2A 8.36e-01 0.9476923
#&gt; ATRX   8.40e-01 0.9476923
#&gt; TP53   8.49e-01 0.9476923
#&gt; PIK3CA 8.80e-01 0.9476923
#&gt; KRAS   1.00e+00 1.0000000
#&gt; 
#&gt; $forest.plot</div><div class='output co'>#&gt; 
#&gt; $vPlot</div><div class='output co'>#&gt; <span class='message'>No trace type specified:</span>
#&gt; <span class='message'>  Based on info supplied, a 'scatter' trace seems appropriate.</span>
#&gt; <span class='message'>  Read more about this trace type -&gt; https://plotly.com/r/reference/#scatter</span></div><div class='img'><img src='gen.summary-1.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; </div><div class='input'><span class='co'>## Continuous outcome ##</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>outcome</span> <span class='op'>&lt;-</span>  <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>gen.dat</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>tab.out</span> <span class='op'>&lt;-</span> <span class='fu'>gen.summary</span><span class='op'>(</span>gen.dat <span class='op'>=</span> <span class='va'>gen.dat</span>,
                   outcome <span class='op'>=</span> <span class='va'>outcome</span>,
                   filter <span class='op'>=</span> <span class='fl'>0.05</span>,
                   cont <span class='op'>=</span> <span class='cn'>TRUE</span>,rank <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>tab.out</span><span class='op'>$</span><span class='va'>fits</span>
</div><div class='output co'>#&gt;          Feature EventFrequency Estimate    SD  Lower Upper   Pvalue      FDR
#&gt; PIK3CA.x PIK3CA           0.107   -0.235 0.149 -0.526 0.056 1.14e-01 9.46e-01
#&gt; RB1.x       RB1           0.050   -0.291 0.210 -0.704 0.121 1.67e-01 9.46e-01
#&gt; TERT.x     TERT           0.149    0.165 0.129 -0.088 0.418 2.03e-01 9.46e-01
#&gt; BRAF.x     BRAF           0.050    0.226 0.211 -0.187 0.639 2.83e-01 9.77e-01
#&gt; TP53.x     TP53           0.429    0.073 0.093 -0.109 0.256 4.31e-01 9.77e-01
#&gt; ATRX.x     ATRX           0.057    0.125 0.199 -0.265 0.515 5.30e-01 9.77e-01
#&gt; NOTCH1.x NOTCH1           0.055   -0.085 0.203 -0.482 0.312 6.75e-01 9.77e-01
#&gt; KRAS.x     KRAS           0.127    0.056 0.138 -0.216 0.327 6.87e-01 9.77e-01
#&gt; CDKN2A.x CDKN2A           0.053    0.061 0.207 -0.344 0.466 7.68e-01 9.77e-01
#&gt; APC.x       APC           0.079   -0.039 0.171 -0.375 0.296 8.18e-01 9.77e-01
#&gt; ARID1A.x ARID1A           0.079   -0.034 0.171 -0.370 0.301 8.40e-01 9.77e-01
#&gt; EGFR.x     EGFR           0.085   -0.019 0.165 -0.343 0.304 9.06e-01 9.77e-01
#&gt; ATM.x       ATM           0.055    0.018 0.203 -0.380 0.415 9.30e-01 9.77e-01
#&gt; FAT1.x     FAT1           0.061   -0.005 0.192 -0.382 0.371 9.77e-01 9.77e-01</div><div class='input'><span class='va'>tab.out</span><span class='op'>$</span><span class='va'>vPlot</span>
</div><div class='output co'>#&gt; <span class='message'>No trace type specified:</span>
#&gt; <span class='message'>  Based on info supplied, a 'scatter' trace seems appropriate.</span>
#&gt; <span class='message'>  Read more about this trace type -&gt; https://plotly.com/r/reference/#scatter</span></div><div class='output co'>#&gt; <span class='warning'>Warning: `line.width` does not currently support multiple values.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: minimal value for n is 3, returning requested palette with 3 different levels</span></div><div class='output co'>#&gt; <span class='warning'>Warning: minimal value for n is 3, returning requested palette with 3 different levels</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Axel Martin, Arshi Arora, Karissa Whiting, Margie Hannum.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


