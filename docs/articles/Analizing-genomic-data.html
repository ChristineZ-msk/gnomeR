<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analizing genomic data • gnomeR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Analizing genomic data">
<meta property="og:description" content="gnomeR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gnomeR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Analizing-genomic-data.html">Analizing genomic data</a>
    </li>
    <li>
      <a href="../articles/Data-processing.html">Data-processing</a>
    </li>
    <li>
      <a href="../articles/Visualizations.html">Visualizations</a>
    </li>
    <li>
      <a href="../articles/gnomeR-vignette.html">gnomeR for IMPACT data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/AxelitoMartin/gnomeR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Analizing-genomic-data_files/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="Analizing-genomic-data_files/htmlwidgets-1.5.3/htmlwidgets.js"></script><script src="Analizing-genomic-data_files/plotly-binding-4.9.3/plotly.js"></script><script src="Analizing-genomic-data_files/typedarray-0.1/typedarray.min.js"></script><script src="Analizing-genomic-data_files/jquery-1.11.3/jquery.min.js"></script><link href="Analizing-genomic-data_files/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet">
<script src="Analizing-genomic-data_files/crosstalk-1.1.0.1/js/crosstalk.min.js"></script><link href="Analizing-genomic-data_files/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="Analizing-genomic-data_files/plotly-main-1.57.1/plotly-latest.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Analizing genomic data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/AxelitoMartin/gnomeR/blob/master/vignettes/Analizing-genomic-data.Rmd"><code>vignettes/Analizing-genomic-data.Rmd</code></a></small>
      <div class="hidden name"><code>Analizing-genomic-data.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/AxelitoMartin/gnomeR">gnomeR</a></span><span class="op">)</span></code></pre></div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>In this article we will cover functions integrated in <code>gnomeR</code> to analyze the outputed processed data of the <code><a href="../reference/binmat.html">binmat()</a></code> function. We include in <code>gnomeR</code> the following functions for analysis:</p>
<ul>
<li><p><code><a href="../reference/gen.summary.html">gen.summary()</a></code> which test for association between either categorical or continous outcomes and the set of genomic features from the <code><a href="../reference/binmat.html">binmat()</a></code> output matrix. Returns a table with the distribution of the genomic features along the outcome specified, using adapted tests and adjustements for multiple testing to report significance. We further summarize the results using adequate plots.</p></li>
<li><p><code><a href="../reference/uni.cox.html">uni.cox()</a></code> which performs univariate assocition analysis between a time-dependent outcome and the set of genomic features from the <code><a href="../reference/binmat.html">binmat()</a></code> output matrix. We perform this using Cox’s proportional hazard models with multiple test adjustements and summary plots.</p></li>
</ul>
</div>
<div id="categorical-and-continous-outcomes" class="section level1">
<h1 class="hasAnchor">
<a href="#categorical-and-continous-outcomes" class="anchor"></a>Categorical and continous outcomes</h1>
<p>In this first section we focus on the <code><a href="../reference/gen.summary.html">gen.summary()</a></code> function, it takes the following arguments:</p>
<ul>
<li>
<code>gen.dat</code> a genomic dataframe outputed from <code><a href="../reference/binmat.html">binmat()</a></code>.</li>
<li>
<code>outcome</code> a leveled vector of length equal to the number of rows in <code>gen.dat</code>.</li>
<li>
<code>filter</code> a numeric value between 0 and 1 (1 not included) that is the lower bound for the proportion of patients having a genetic event. All features with an event rate lower than that value will be removed. Default is 0 (all features included).</li>
<li>
<code>paired</code> Boolean if the data are paired. Default is FALSE.</li>
<li>
<code>cont</code> Should the outcome be treated as a continuous value. Default is FALSE treated as categorical.</li>
<li>
<code>rank</code> Should the table returned be ordered by Pvalue. Boolean, default is TRUE.</li>
</ul>
<p>In the following analyses we will be using the following subset of samples:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>
<span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">mut</span><span class="op">$</span><span class="va">Tumor_Sample_Barcode</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">mut</span><span class="op">$</span><span class="va">Tumor_Sample_Barcode</span><span class="op">)</span><span class="op">)</span>, <span class="fl">100</span>, replace<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">]</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binmat.html">binmat</a></span><span class="op">(</span>patients <span class="op">=</span> <span class="va">samples</span>,maf <span class="op">=</span> <span class="va">mut</span>, fusion <span class="op">=</span> <span class="va">fusion</span>, cna <span class="op">=</span> <span class="va">cna</span>, cna.binary <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div id="categorical" class="section level2">
<h2 class="hasAnchor">
<a href="#categorical" class="anchor"></a>Categorical</h2>
<p>For this example we will be using the recorded sample type of the samples we randomly selected above. Thus looking for differences between primary and metastatic samples:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">outcome</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">clin.sample</span><span class="op">$</span><span class="va">Sample.Type</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span><span class="op">(</span><span class="va">samples</span>,<span class="va">clin.sample</span><span class="op">$</span><span class="va">Sample.Identifier</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gen.summary.html">gen.summary</a></span><span class="op">(</span>gen.dat <span class="op">=</span> <span class="va">df</span>,
                outcome <span class="op">=</span> <span class="va">outcome</span>,
                filter <span class="op">=</span> <span class="fl">0.05</span>,
                cont <span class="op">=</span> <span class="cn">FALSE</span>,rank <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>Using the Fisher’s exact test the <code><a href="../reference/gen.summary.html">gen.summary()</a></code> function returns the following:</p>
<ul>
<li>
<code>fits</code> a summary table of the distribution of features across outcomes and the test performed</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">kable</span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">fits</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span><span class="op">)</span></code></pre></div>
<table class="table">
<colgroup>
<col width="19%">
<col width="19%">
<col width="6%">
<col width="13%">
<col width="11%">
<col width="7%">
<col width="4%">
<col width="5%">
<col width="7%">
<col width="5%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="left">Feature</th>
<th align="left">Overall</th>
<th align="left">Metastasis(N=55)</th>
<th align="left">Primary(N=45)</th>
<th align="left">OddsRatio</th>
<th align="left">Lower</th>
<th align="left">Upper</th>
<th align="left">Pvalue</th>
<th align="right">FDR</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">CDK12.cna.AMPLIFICATION</td>
<td align="left">CDK12.cna.AMPLIFICATION</td>
<td align="left">6%</td>
<td align="left">0%</td>
<td align="left">13.333%</td>
<td align="left">Inf</td>
<td align="left">1.54</td>
<td align="left">Inf</td>
<td align="left">6.83e-03</td>
<td align="right">0.1944</td>
</tr>
<tr class="even">
<td align="left">STK11</td>
<td align="left">STK11</td>
<td align="left">7%</td>
<td align="left">12.727%</td>
<td align="left">0%</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0.8</td>
<td align="left">1.55e-02</td>
<td align="right">0.1944</td>
</tr>
<tr class="odd">
<td align="left">ERBB2.cna.AMPLIFICATION</td>
<td align="left">ERBB2.cna.AMPLIFICATION</td>
<td align="left">5%</td>
<td align="left">0%</td>
<td align="left">11.111%</td>
<td align="left">Inf</td>
<td align="left">1.18</td>
<td align="left">Inf</td>
<td align="left">1.62e-02</td>
<td align="right">0.1944</td>
</tr>
<tr class="even">
<td align="left">FGFR1.cna.AMPLIFICATION</td>
<td align="left">FGFR1.cna.AMPLIFICATION</td>
<td align="left">6%</td>
<td align="left">1.818%</td>
<td align="left">11.111%</td>
<td align="left">6.64</td>
<td align="left">0.7</td>
<td align="left">324.48</td>
<td align="left">8.75e-02</td>
<td align="right">0.6840</td>
</tr>
<tr class="odd">
<td align="left">NOTCH1</td>
<td align="left">NOTCH1</td>
<td align="left">8%</td>
<td align="left">3.636%</td>
<td align="left">13.333%</td>
<td align="left">4.02</td>
<td align="left">0.67</td>
<td align="left">42.79</td>
<td align="left">1.35e-01</td>
<td align="right">0.6840</td>
</tr>
<tr class="even">
<td align="left">TP53</td>
<td align="left">TP53</td>
<td align="left">38%</td>
<td align="left">30.909%</td>
<td align="left">46.667%</td>
<td align="left">1.94</td>
<td align="left">0.8</td>
<td align="left">4.81</td>
<td align="left">1.47e-01</td>
<td align="right">0.6840</td>
</tr>
<tr class="odd">
<td align="left">TERT</td>
<td align="left">TERT</td>
<td align="left">15%</td>
<td align="left">20%</td>
<td align="left">8.889%</td>
<td align="left">0.39</td>
<td align="left">0.08</td>
<td align="left">1.46</td>
<td align="left">1.62e-01</td>
<td align="right">0.6840</td>
</tr>
<tr class="even">
<td align="left">DOT1L</td>
<td align="left">DOT1L</td>
<td align="left">5%</td>
<td align="left">1.818%</td>
<td align="left">8.889%</td>
<td align="left">5.19</td>
<td align="left">0.49</td>
<td align="left">263.77</td>
<td align="left">1.71e-01</td>
<td align="right">0.6840</td>
</tr>
<tr class="odd">
<td align="left">GATA3</td>
<td align="left">GATA3</td>
<td align="left">5%</td>
<td align="left">1.818%</td>
<td align="left">8.889%</td>
<td align="left">5.19</td>
<td align="left">0.49</td>
<td align="left">263.77</td>
<td align="left">1.71e-01</td>
<td align="right">0.6840</td>
</tr>
<tr class="even">
<td align="left">PTPRT</td>
<td align="left">PTPRT</td>
<td align="left">6%</td>
<td align="left">9.091%</td>
<td align="left">2.222%</td>
<td align="left">0.23</td>
<td align="left">0</td>
<td align="left">2.17</td>
<td align="left">2.19e-01</td>
<td align="right">0.7140</td>
</tr>
</tbody>
</table>
<ul>
<li>
<code>forest.plot</code> a forest plot of the most significant features</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">test</span><span class="op">$</span><span class="va">forest.plot</span></code></pre></div>
<p><img src="Analizing-genomic-data_files/figure-html/unnamed-chunk-6-1.png" width="960"></p>
<ul>
<li>
<code>vPlot</code> a volcano plot summarising the odds ratios and pvalues of the the features included in the test</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">test</span><span class="op">$</span><span class="va">vPlot</span></code></pre></div>
<div id="htmlwidget-54a4873249b169eb6149" style="width:960px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-54a4873249b169eb6149">{"x":{"visdat":{"e47d278c96d1":["function () ","plotlyVisDat"]},"cur_data":"e47d278c96d1","attrs":{"e47d278c96d1":{"x":{},"y":{},"text":{},"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20]}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Volcano Plot","xaxis":{"domain":[0,1],"automargin":true,"title":".data$OddsRatio"},"yaxis":{"domain":[0,1],"automargin":true,"title":"-log10(.data$Pvalue)"},"hovermode":"closest","showlegend":false},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[null,0,null,6.64,4.02,1.94,0.39,5.19,5.19,0.23,0.23,3.27,0.29,0.29,2.56,2.56,2.56,2.15,1.88,1.88,1.88,1.88,0.6,0.6,0.6,1.68,1.59,1.25,0.74,0.81,1.02,1.24,0.81,1.24,1.24,0.81],"y":[2.16557929631847,1.80966830182971,1.79048498545737,1.05799194697769,0.869666231504994,0.832682665251824,0.790484985457369,0.767003889607846,0.767003889607846,0.659555885159882,0.659555885159882,0.623423042943488,0.425968732272281,0.425968732272281,0.393618634889395,0.393618634889395,0.393618634889395,0.335358024443874,0.183758700008217,0.183758700008217,0.183758700008217,0.183758700008217,0.162411561764489,0.162411561764489,0.162411561764489,0.156144577376839,0.137868620686963,0.11690664142431,0.114638779968488,-0,-0,-0,-0,-0,-0,-0],"text":["Gene : CDK12.cna.AMPLIFICATION <\/br> Odds Ratio : Inf","Gene : STK11 <\/br> Odds Ratio : 0","Gene : ERBB2.cna.AMPLIFICATION <\/br> Odds Ratio : Inf","Gene : FGFR1.cna.AMPLIFICATION <\/br> Odds Ratio : 6.64","Gene : NOTCH1 <\/br> Odds Ratio : 4.02","Gene : TP53 <\/br> Odds Ratio : 1.94","Gene : TERT <\/br> Odds Ratio : 0.39","Gene : DOT1L <\/br> Odds Ratio : 5.19","Gene : GATA3 <\/br> Odds Ratio : 5.19","Gene : PTPRT <\/br> Odds Ratio : 0.23","Gene : MYC.cna.AMPLIFICATION <\/br> Odds Ratio : 0.23","Gene : CREBBP <\/br> Odds Ratio : 3.27","Gene : KEAP1 <\/br> Odds Ratio : 0.29","Gene : EPHA5 <\/br> Odds Ratio : 0.29","Gene : CDH1 <\/br> Odds Ratio : 2.56","Gene : ATM <\/br> Odds Ratio : 2.56","Gene : ALK <\/br> Odds Ratio : 2.56","Gene : PTPRD <\/br> Odds Ratio : 2.15","Gene : AR <\/br> Odds Ratio : 1.88","Gene : TSC1 <\/br> Odds Ratio : 1.88","Gene : SMARCA4 <\/br> Odds Ratio : 1.88","Gene : NOTCH3 <\/br> Odds Ratio : 1.88","Gene : RB1 <\/br> Odds Ratio : 0.6","Gene : BRAF <\/br> Odds Ratio : 0.6","Gene : MCL1.cna.AMPLIFICATION <\/br> Odds Ratio : 0.6","Gene : APC <\/br> Odds Ratio : 1.68","Gene : EGFR <\/br> Odds Ratio : 1.59","Gene : PIK3CA <\/br> Odds Ratio : 1.25","Gene : KRAS <\/br> Odds Ratio : 0.74","Gene : FLT4 <\/br> Odds Ratio : 0.81","Gene : FAT1 <\/br> Odds Ratio : 1.02","Gene : PIK3C2G <\/br> Odds Ratio : 1.24","Gene : CCND1.cna.AMPLIFICATION <\/br> Odds Ratio : 0.81","Gene : CDKN2A.cna.DELETION <\/br> Odds Ratio : 1.24","Gene : CDKN2B.cna.DELETION <\/br> Odds Ratio : 1.24","Gene : FGF19.cna.AMPLIFICATION <\/br> Odds Ratio : 0.81"],"mode":"markers","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="continous" class="section level2">
<h2 class="hasAnchor">
<a href="#continous" class="anchor"></a>Continous</h2>
<p>In this section we show to use the <code><a href="../reference/gen.summary.html">gen.summary()</a></code> function with a continuous outcome. Given the lack of continuous variables in the IMPACT clinical set we show an example here with a simulate continuous gaussian outcome. We perform this using linear regression.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="va">outcome</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span>
<span class="va">tab.out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gen.summary.html">gen.summary</a></span><span class="op">(</span>gen.dat <span class="op">=</span> <span class="va">df</span>,
                   outcome <span class="op">=</span> <span class="va">outcome</span>,
                   filter <span class="op">=</span> <span class="fl">0.05</span>,
                   cont <span class="op">=</span> <span class="cn">TRUE</span>,rank <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>This returns the following:</p>
<ul>
<li>
<code>fits</code> a summary of the univariate fits that were performed</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">kable</span><span class="op">(</span><span class="va">tab.out</span><span class="op">$</span><span class="va">fits</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">Feature</th>
<th align="right">EventFrequency</th>
<th align="right">Estimate</th>
<th align="right">SD</th>
<th align="right">Lower</th>
<th align="right">Upper</th>
<th align="left">Pvalue</th>
<th align="left">FDR</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">SMARCA4.x</td>
<td align="left">SMARCA4</td>
<td align="right">0.05</td>
<td align="right">1.116</td>
<td align="right">0.399</td>
<td align="right">0.335</td>
<td align="right">1.898</td>
<td align="left">6.13e-03</td>
<td align="left">2.21e-01</td>
</tr>
<tr class="even">
<td align="left">DOT1L.x</td>
<td align="left">DOT1L</td>
<td align="right">0.05</td>
<td align="right">1.007</td>
<td align="right">0.402</td>
<td align="right">0.220</td>
<td align="right">1.794</td>
<td align="left">1.38e-02</td>
<td align="left">2.49e-01</td>
</tr>
<tr class="odd">
<td align="left">KEAP1.x</td>
<td align="left">KEAP1</td>
<td align="right">0.05</td>
<td align="right">0.723</td>
<td align="right">0.408</td>
<td align="right">-0.077</td>
<td align="right">1.522</td>
<td align="left">7.95e-02</td>
<td align="left">5.40e-01</td>
</tr>
<tr class="even">
<td align="left">NOTCH3.x</td>
<td align="left">NOTCH3</td>
<td align="right">0.05</td>
<td align="right">0.651</td>
<td align="right">0.409</td>
<td align="right">-0.151</td>
<td align="right">1.453</td>
<td align="left">1.15e-01</td>
<td align="left">5.40e-01</td>
</tr>
<tr class="odd">
<td align="left">ALK.x</td>
<td align="left">ALK</td>
<td align="right">0.06</td>
<td align="right">0.566</td>
<td align="right">0.376</td>
<td align="right">-0.171</td>
<td align="right">1.302</td>
<td align="left">1.35e-01</td>
<td align="left">5.40e-01</td>
</tr>
<tr class="even">
<td align="left">KRAS.x</td>
<td align="left">KRAS</td>
<td align="right">0.13</td>
<td align="right">0.388</td>
<td align="right">0.266</td>
<td align="right">-0.133</td>
<td align="right">0.908</td>
<td align="left">1.47e-01</td>
<td align="left">5.40e-01</td>
</tr>
<tr class="odd">
<td align="left">AR.x</td>
<td align="left">AR</td>
<td align="right">0.05</td>
<td align="right">0.583</td>
<td align="right">0.410</td>
<td align="right">-0.221</td>
<td align="right">1.387</td>
<td align="left">1.58e-01</td>
<td align="left">5.40e-01</td>
</tr>
<tr class="even">
<td align="left">NOTCH1.x</td>
<td align="left">NOTCH1</td>
<td align="right">0.08</td>
<td align="right">0.462</td>
<td align="right">0.329</td>
<td align="right">-0.184</td>
<td align="right">1.107</td>
<td align="left">1.64e-01</td>
<td align="left">5.40e-01</td>
</tr>
<tr class="odd">
<td align="left">EPHA5.x</td>
<td align="left">EPHA5</td>
<td align="right">0.05</td>
<td align="right">0.563</td>
<td align="right">0.410</td>
<td align="right">-0.241</td>
<td align="right">1.368</td>
<td align="left">1.73e-01</td>
<td align="left">5.40e-01</td>
</tr>
<tr class="even">
<td align="left">FAT1.x</td>
<td align="left">FAT1</td>
<td align="right">0.11</td>
<td align="right">0.381</td>
<td align="right">0.286</td>
<td align="right">-0.179</td>
<td align="right">0.942</td>
<td align="left">1.86e-01</td>
<td align="left">5.40e-01</td>
</tr>
</tbody>
</table>
<ul>
<li>
<code>vPlot</code> a volcano plot summarising the coefficient and pvalues of the the features included in the test</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tab.out</span><span class="op">$</span><span class="va">vPlot</span></code></pre></div>
<div id="htmlwidget-d57ecbd3ad10bd2d35a2" style="width:960px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-d57ecbd3ad10bd2d35a2">{"x":{"visdat":{"e47dc4709c6":["function () ","plotlyVisDat"]},"cur_data":"e47dc4709c6","attrs":{"e47dc4709c6":{"x":{},"y":{},"text":{},"mode":"markers","color":{},"size":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20]}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Volcano Plot","xaxis":{"domain":[0,1],"automargin":true,"title":"Estimate"},"yaxis":{"domain":[0,1],"automargin":true,"title":"-log10(Pvalue)"},"hovermode":"closest","showlegend":false},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[1.116,1.007,0.723,0.651,0.566,0.388,0.583,0.462,0.563,0.381,0.49,0.488,0.474,-0.453,-0.45,-0.464,0.456,0.456,0.342,0.36,-0.382,-0.329,-0.295,0.181,0.235,0.221,-0.145,0.163,0.144,0.094,-0.116,0.06,0.123,-0.127,-0.003,0.001],"y":[2.21253952548158,1.86012091359876,1.09963287134353,0.939302159646388,0.869666231504994,0.832682665251824,0.801342913045577,0.785156151952302,0.761953896871205,0.730487055782084,0.707743928643524,0.703334809738469,0.673664139071249,0.632644078973981,0.627087997029893,0.580044251510242,0.568636235841013,0.568636235841013,0.517126416391246,0.510041520575165,0.500312917381596,0.369572124974976,0.3585258894959,0.323306390375133,0.270025714300444,0.250263684430939,0.177178354696895,0.175223537524454,0.137272471682025,0.132532512140949,0.129011186239425,0.126679398184601,0.126679398184601,0.119186407719209,0.00261361560268669,0.000869458712628891],"text":["Feature : SMARCA4  <\/br> Estimate : 1.12","Feature : DOT1L  <\/br> Estimate : 1.01","Feature : KEAP1  <\/br> Estimate : 0.72","Feature : NOTCH3  <\/br> Estimate : 0.65","Feature : ALK  <\/br> Estimate : 0.57","Feature : KRAS  <\/br> Estimate : 0.39","Feature : AR  <\/br> Estimate : 0.58","Feature : NOTCH1  <\/br> Estimate : 0.46","Feature : EPHA5  <\/br> Estimate : 0.56","Feature : FAT1  <\/br> Estimate : 0.38","Feature : BRAF  <\/br> Estimate : 0.49","Feature : MCL1_cna AMPLIFICATION <\/br> Estimate : 0.49","Feature : PTPRT  <\/br> Estimate : 0.47","Feature : FGFR1_cna AMPLIFICATION <\/br> Estimate : -0.45","Feature : CDH1  <\/br> Estimate : -0.45","Feature : FLT4  <\/br> Estimate : -0.46","Feature : CCND1_cna AMPLIFICATION <\/br> Estimate : 0.46","Feature : FGF19_cna AMPLIFICATION <\/br> Estimate : 0.46","Feature : PTPRD  <\/br> Estimate : 0.34","Feature : CREBBP  <\/br> Estimate : 0.36","Feature : CDK12_cna AMPLIFICATION <\/br> Estimate : -0.38","Feature : ERBB2_cna AMPLIFICATION <\/br> Estimate : -0.33","Feature : MYC_cna AMPLIFICATION <\/br> Estimate : -0.3","Feature : TERT  <\/br> Estimate : 0.18","Feature : ATM  <\/br> Estimate : 0.23","Feature : CDKN2B_cna DELETION <\/br> Estimate : 0.22","Feature : CDKN2A_cna DELETION <\/br> Estimate : -0.14","Feature : PIK3C2G  <\/br> Estimate : 0.16","Feature : GATA3  <\/br> Estimate : 0.14","Feature : PIK3CA  <\/br> Estimate : 0.09","Feature : APC  <\/br> Estimate : -0.12","Feature : TP53  <\/br> Estimate : 0.06","Feature : RB1  <\/br> Estimate : 0.12","Feature : TSC1  <\/br> Estimate : -0.13","Feature : STK11  <\/br> Estimate : 0","Feature : EGFR  <\/br> Estimate : 0"],"mode":"markers","type":"scatter","name":"Non signifcant","marker":{"color":"rgba(252,141,98,1)","size":[10,10,10,10,12.7272727272727,31.8181818181818,10,18.1818181818182,10,26.3636363636364,12.7272727272727,12.7272727272727,12.7272727272727,12.7272727272727,12.7272727272727,10,10,10,18.1818181818182,15.4545454545455,12.7272727272727,10,12.7272727272727,37.2727272727273,12.7272727272727,12.7272727272727,18.1818181818182,12.7272727272727,10,29.0909090909091,15.4545454545455,100,12.7272727272727,10,15.4545454545455,20.9090909090909],"sizemode":"area","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)","size":[10,10,10,10,12.7272727272727,31.8181818181818,10,18.1818181818182,10,26.3636363636364,12.7272727272727,12.7272727272727,12.7272727272727,12.7272727272727,12.7272727272727,10,10,10,18.1818181818182,15.4545454545455,12.7272727272727,10,12.7272727272727,37.2727272727273,12.7272727272727,12.7272727272727,18.1818181818182,12.7272727272727,10,29.0909090909091,15.4545454545455,100,12.7272727272727,10,15.4545454545455,20.9090909090909]},"error_y":{"color":"rgba(252,141,98,1)","width":[]},"error_x":{"color":"rgba(252,141,98,1)","width":[]},"line":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="survival-outcome" class="section level1">
<h1 class="hasAnchor">
<a href="#survival-outcome" class="anchor"></a>Survival outcome</h1>
<p>The univariate survival analysis can be performed using the <code><a href="../reference/uni.cox.html">uni.cox()</a></code> function, it takes the following arguments:</p>
<ul>
<li>
<code>X</code> a matrix/surv.datframe of genomic features, continuous or binary (note cannot handle categorical surv.dat for the moment).</li>
<li>
<code>surv.dat</code> a survival dataframe containing the survival information. This can be made of 2 or 3 columns. 1 or 2 for time, and one for status (where 1 is event and 0 is no event).</li>
<li>
<code>surv.formula</code> a survival formula with names matching those in surv.dat eg: Surv(time,status)~.</li>
<li>
<code>filter</code> a numeric value between 0 and 1 (1 not included) that is the lower bound for the proportion of patients having a genetic event. All features with an event rate lower than that value will be removed. Default is 0 (all features included).</li>
<li>
<code>genes</code> a character vector of gene names that will be the only ones to be kept. Default is NULL, all genes are used.</li>
</ul>
<p>Here we show an example using the survival data included in the IMPACT clinical dataset:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">surv.dat</span> <span class="op">&lt;-</span> <span class="va">clin.patients</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">X.Patient.Identifier</span> <span class="op">%in%</span>
           <span class="fu"><a href="https://rdrr.io/r/base/abbreviate.html">abbreviate</a></span><span class="op">(</span><span class="va">samples</span>,strict <span class="op">=</span> <span class="cn">TRUE</span>, minlength <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">X.Patient.Identifier</span>,<span class="va">Overall.Survival..Months.</span>,
         <span class="va">Overall.Survival.Status</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>DMPID <span class="op">=</span> <span class="va">X.Patient.Identifier</span>,
         time <span class="op">=</span> <span class="va">Overall.Survival..Months.</span>,
         status <span class="op">=</span> <span class="va">Overall.Survival.Status</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span>,
         status <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">status</span> <span class="op">==</span> <span class="st">"LIVING"</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span>
<span class="va">X</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span><span class="op">(</span><span class="va">surv.dat</span><span class="op">$</span><span class="va">DMPID</span>,
                   <span class="fu"><a href="https://rdrr.io/r/base/abbreviate.html">abbreviate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>,strict <span class="op">=</span> <span class="cn">TRUE</span>, minlength <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span>
<span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/uni.cox.html">uni.cox</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">X</span>, surv.dat <span class="op">=</span> <span class="va">surv.dat</span>, 
        surv.formula <span class="op">=</span> <span class="fu">Surv</span><span class="op">(</span><span class="va">time</span>,<span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="va">.</span>,filter <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></code></pre></div>
<p>This returns the following:</p>
<ul>
<li>
<code>tab</code> a summary of the univariate fits that were performed</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">kable</span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">tab</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">Feature</th>
<th align="right">EventFrequency</th>
<th align="right">Estimate</th>
<th align="right">HR</th>
<th align="right">SD</th>
<th align="right">Lower</th>
<th align="right">Upper</th>
<th align="left">Pvalue</th>
<th align="left">FDR</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">TERT.x</td>
<td align="left">TERT</td>
<td align="right">0.137</td>
<td align="right">0.890</td>
<td align="right">2.435</td>
<td align="right">0.471</td>
<td align="right">0.967</td>
<td align="right">6.134</td>
<td align="left">5.90e-02</td>
<td align="left">2.95e-01</td>
</tr>
<tr class="even">
<td align="left">TP53.x</td>
<td align="left">TP53</td>
<td align="right">0.356</td>
<td align="right">0.486</td>
<td align="right">1.626</td>
<td align="right">0.404</td>
<td align="right">0.737</td>
<td align="right">3.590</td>
<td align="left">2.29e-01</td>
<td align="left">5.72e-01</td>
</tr>
<tr class="odd">
<td align="left">PIK3CA.x</td>
<td align="left">PIK3CA</td>
<td align="right">0.137</td>
<td align="right">0.381</td>
<td align="right">1.463</td>
<td align="right">0.501</td>
<td align="right">0.549</td>
<td align="right">3.903</td>
<td align="left">4.47e-01</td>
<td align="left">7.10e-01</td>
</tr>
<tr class="even">
<td align="left">KRAS.x</td>
<td align="left">KRAS</td>
<td align="right">0.137</td>
<td align="right">-0.421</td>
<td align="right">0.656</td>
<td align="right">0.738</td>
<td align="right">0.155</td>
<td align="right">2.787</td>
<td align="left">5.68e-01</td>
<td align="left">7.10e-01</td>
</tr>
<tr class="odd">
<td align="left">FAT1.x</td>
<td align="left">FAT1</td>
<td align="right">0.137</td>
<td align="right">0.131</td>
<td align="right">1.140</td>
<td align="right">0.548</td>
<td align="right">0.389</td>
<td align="right">3.337</td>
<td align="left">8.11e-01</td>
<td align="left">8.11e-01</td>
</tr>
</tbody>
</table>
<ul>
<li>
<code>p</code> an interactive volcano plot summarizing the hazard ratio for each ratio as a function of it’s p-value</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">test</span><span class="op">$</span><span class="va">p</span></code></pre></div>
<div id="htmlwidget-e76df25d4e1770d66a86" style="width:960px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-e76df25d4e1770d66a86">{"x":{"visdat":{"e47d22bc7088":["function () ","plotlyVisDat"]},"cur_data":"e47d22bc7088","attrs":{"e47d22bc7088":{"x":{},"y":{},"text":{},"mode":"markers","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20]}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Volcano Plot","xaxis":{"domain":[0,1],"automargin":true,"title":"Estimate"},"yaxis":{"domain":[0,1],"automargin":true,"title":"-log10(Pvalue)"},"hovermode":"closest","showlegend":false},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[0.89,0.486,0.381,-0.421,0.131],"y":[1.22914798835786,0.640164517660112,0.349692476868064,0.245651664288981,0.0909791457888439],"text":["Feature : TERT  <br> Hazard Ratio : 2.435 <br> Event Frequency : 0.137","Feature : TP53  <br> Hazard Ratio : 1.626 <br> Event Frequency : 0.356","Feature : PIK3CA  <br> Hazard Ratio : 1.463 <br> Event Frequency : 0.137","Feature : KRAS  <br> Hazard Ratio : 0.656 <br> Event Frequency : 0.137","Feature : FAT1  <br> Hazard Ratio : 1.14 <br> Event Frequency : 0.137"],"mode":"markers","type":"scatter","name":"red","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"line":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><ul>
<li>
<code>KM</code> a list of Kaplan-Meier plots for the 10 most significant features</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">test</span><span class="op">$</span><span class="va">KM</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<p><img src="Analizing-genomic-data_files/figure-html/unnamed-chunk-14-1.png" width="960"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Axel Martin, Arshi Arora, Karissa Whiting, Margie Hannum.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
